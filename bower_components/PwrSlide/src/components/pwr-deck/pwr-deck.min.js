(function(){var SLIDE_ATTRS_=["past","current","next"],PREFIXES_=["webkit","moz","MS","o",""],prevSlide_=0,onKeyDown_=function(e){if(/^(input|textarea)$/i.test(e.target.nodeName)||e.target.isContentEditable||!this.controlsActive){return}switch(e.keyCode){case 39:case 32:case 34:case 40:if(!!e.shiftKey){this.current++}else{this.nextSlide();e.preventDefault()}break;case 37:case 33:case 38:this.prevSlide();e.preventDefault();break;case 70:if(!(e.shiftKey&&e.metaKey)){if(this.mozRequestFullScreen){this.mozRequestFullScreen()}else if(this.webkitRequestFullScreen){this.webkitRequestFullScreen()}}break}},addPrefixedListeners_=function(elem,type,callback){for(var i=PREFIXES_.length-1;i>=0;i--){elem.addEventListener(PREFIXES_[i]+type,callback,false)}},addEventListeners_=function(){document.addEventListener("keydown",onKeyDown_.bind(this),false);this.addEventListener("animationend",handleAnimated_.bind(this),false);addPrefixedListeners_(this,"AnimationEnd",handleAnimated_.bind(this))},handleAnimated_=function(e){if(e.target instanceof PwrAnimated){var el=e.target;e.stopPropagation();if(e.animationName===el.exit){if(el.nodeName==="PWR-SLIDE"){this.curSlide.animateIn();updateSlides_.call(this);[].forEach.call(prevSlide_.pieces,function(el){el.removeAnimations()})}}else if(e.animationName===el.entrance){if(el.onentry){try{new Function(el.onentry).call(el)}catch(e){console.log("onentry callback error: "+e)}}}}},loadSlide_=function(slideNum){if(slideNum<0||slideNum>=this.totalSlides){return null}else{prevSlide_=this.curSlide;this.curSlide=this.getSlide(slideNum);this.fire("slidechange",{slideIndex:slideNum,curSlide:this.curSlide});prevSlide_.animateOut()}},updateSlides_=function(){var current=this.current,updateSlideAttr=updateSlideAttr_.bind(this);this.curSlide=this.slides[this.current-1];for(var i=1;i<=this.totalSlides;++i){switch(i){case current-1:updateSlideAttr(i,"past");break;case current:updateSlideAttr(i,"current");break;case current+1:updateSlideAttr(i,"next");break;default:updateSlideAttr(i);break}}},updateSlideAttr_=function(slideNum,attrName){var slide=this.getSlide(slideNum-1);if(!slide){return}if(attrName){slide.setAttribute(attrName,"")}for(var i=0,slideAttr;slideAttr=SLIDE_ATTRS_[i];++i){if(attrName!=slideAttr){slide.removeAttribute(slideAttr)}}};Polymer("pwr-deck",{current:1,curSlide:null,controlsActive:false,enablecontrols:true,publish:{totalSlides:0},currentChanged:function(oldVal,newVal){if(newVal>0&&newVal<=this.totalSlides){loadSlide_.call(this,newVal-1)}},slidesChanged:function(oldVal,newVal){if(newVal instanceof Array||newVal instanceof NodeList){updateSlides_.call(this)}else{this.slides=oldVal}},ready:function(){this.slides=this.$.slides.getDistributedNodes();this.totalSlides=this.slides.length;addEventListeners_.call(this);updateSlides_.call(this);if(!!this.onready){try{new Function(this.onready)()}catch(e){console.log("onready callback error: "+e)}}},keyControlsOff:function(e){if(this.enablecontrols){e.stopPropagation();this.controlsActive=false}},keyControlsOn:function(e){if(this.enablecontrols){e.stopPropagation();this.controlsActive=true}},nextSlide:function(){var slide=this.getSlide(this.current-1);if(slide.animateNextPiece()){return}if(this.current<this.totalSlides){this.current++}},prevSlide:function(){if(this.current>1){this.current--}},getSlide:function(slideNum){if(slideNum<0||slideNum>=this.totalSlides){return null}else{return this.slides[slideNum]}}})})();